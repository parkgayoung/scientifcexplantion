---
title: "Quantitative assignment"
author: "Gayoung Park"
date: "2015. 4. 21."
output: html_document
---
```{r}
install.packages(pkgs = "devtools", dependencies = TRUE)
```

```{r}
library(devtools)
install_github("benmarwick/JSTORr")
```


Three potential questions relating with my research question. My research topic is stemmed points and I would like to figure out the driver that let people to make the points and the cause of the changes in stemmed points throughout the Upper Paleolithic in Korea. okay

1. How can I connect the theory of evolution and the starting point of new lithics such as stemmed point in the Upper Plaeolitic period.
2. Is there some relationshipe between the extinction of mammals such as mammoth and change of stone tool? If so, I would like to see the transion between phase to phase of stemmed point based on the theory of the extinction.
3. Which attributes on lithic I should choose to figure out the change of lithic according of climate change?

Code

```{r}
library("JSTORr")
library(dplyr)
#multiple_archives <- JSTOR_unpack_multiple_archives(mydir = "~/scientifcexplantion/data/one_gram")
#jfa <- JSTOR_unpack_multiple_archives(mydir = "~/scientifcexplantion/data/one_gram/jfa")
#save(multiple_archives, file="~/scientifcexplantion/data/one_gram/multiple_archives.RData")

load("data/one_gram/multiple_archives.RData")
```


1. Analyses using all data corpus.

```{r}

JSTOR_1word(multiple_archives, "extinction")
extinction <- JSTOR_1word(multiple_archives, "extinction")
extinction$plot
extinction_tbl <-extinction$word_by_year
extinction_tbl[which.max(extinction_tbl$word_ratio),]

tmp <- JSTOR_2words(multiple_archives, "extinction", "lithic")
# how to find the article with high frequency of the word
tmp$words_by_year %>%
  filter(value > 3)
library(plyr)
tmp1 <- JSTOR_2wordcor(multiple_archives, "extinction", "lithic")
```


2. Analyses using one data corpus (JFA).

(1)Example of pottery
```{r}
library(devtools)

#plot from https://github.com/benmarwick/textual-macroanalysis-gender-archaeology/blob/master/gender.Rmd

#Figure 5

# top words per decade in articles containing 'lithic' 
nouns <- JSTOR_dtmofnouns(multiple_archives, word = NULL, sparse = 1, POStag = TRUE)

PCA_pottery <- JSTOR_clusterbywords(nouns, "pottery", f = 0.005)
```

(2)Example of evolution
```{r}
PCA_evolution <- JSTOR_clusterbywords(nouns, "evolution", f = 0.005)

```

(3)Example of hunter
```{r}
PCA_hunter<- JSTOR_clusterbywords(nouns, "hunter", f = 0.005)

custom_stopwords <- c('archaeology', 'university', 'research', 'evidence', 'journal', 'world', 'site', 'cambridge', 'archaeol', 'area', 'region', 'period', 'analysis', 'anthropology', 'springer', 'production', 'figure', 'work', 'world', 'concept', 'human', 'middle', 'altamira', 'culture', 'record', 'citation', 'discipline', 'author', 'proportion', 'literature', 'report', 'approach', 'cambridge' )

hunter_nouns <- JSTOR_dtmofnouns(jfa, word = "hunter", sparse = 1, POStag = TRUE)

#here is some errors
gender_freqwords <- JSTOR_freqwords(jfa, hunter_nouns, custom_stopwords, n = 3)

```

(4)Example of hunter and climate
```{r}

JSTOR_1word(jfa, "hunter")

JSTOR_2words(jfa, "hunter", "climate")

A <- JSTOR_2words(jfa, "hunter", "climate")

JSTOR_2wordcor(jfa, "hunter", "climate")

#why this code doesn't work??
B <- JSTOR_2wordcor(jfa, "hunter", "climate")


#I could get some plot from these codes.

PCA_hunter_climate<- JSTOR_clusterbywords(nouns, c("hunter", "climate"))

#I can get lots of information using $, %>%. For example, PCA_hunter_climate$PCA$call.


custom_stopwords <- c('archaeology', 'university', 'research', 'evidence', 'journal', 'world', 'site', 'cambridge', 'archaeol', 'area', 'region', 'period', 'analysis', 'anthropology', 'springer', 'production', 'figure', 'work', 'world', 'concept', 'human', 'middle', 'altamira', 'culture', 'record', 'citation', 'discipline', 'author', 'proportion', 'literature', 'report', 'approach', 'cambridge' )

hunter_climate_nouns <- JSTOR_dtmofnouns(jfa, word = c("hunter", "climate"), sparse = 1, POStag = TRUE)

```

Related to question three, the relationship between climate change and lithics, I examined the frequency of words which involve "hunter" and "climate" in the articles of Journal of Field Archaeology. The graphs illustrate the tandancy of using those two words as time passed. Each word has been used frequently from 1970 to 2007 but the combination of those two words mostly used at 1990 and 2002.



#Keywords: lithic, extinction, evolution, projectile, Paleolithic, blade, climate

#extinction, extinction&lithic

```{r}
JSTOR_1word(multiple_archives, "extinction")
JSTOR_2words(multiple_archives, "extinction", "lithic")
JSTOR_2wordcor(multiple_archives, "extinction", "lithic")
nouns <- JSTOR_dtmofnouns(multiple_archives, sparse = 1, POStag = FALSE)
PCA_extinction <- JSTOR_clusterbywords(nouns, "extinction", f = 0.005)
custom_stopwords <- c('archaeology', 'university', 'research', 'evidence', 'journal', 'world', 'site', 'cambridge', 'archaeol', 'area', 'region', 'period', 'analysis', 'anthropology', 'springer', 'production', 'figure', 'work', 'world', 'concept', 'human', 'middle', 'altamira', 'culture', 'record', 'citation', 'discipline', 'author', 'proportion', 'literature', 'report', 'approach', 'cambridge' )
extinction_nouns <- JSTOR_dtmofnouns(multiple_archives, word = "extinction", sparse = 1, POStag = TRUE)

PCA_extinction_lithic <- JSTOR_clusterbywords(nouns, c("extinction","lithic"), f = 0.005)
extinction_lithic_nouns <- JSTOR_dtmofnouns(multiple_archives, word = c("extinction","lithic"), sparse = 1, POStag = TRUE)
```

#evolution, evolution&lithic

```{r}
JSTOR_1word(multiple_archives, "evolution")
JSTOR_2words(multiple_archives, "evolution", "lithic")
JSTOR_2wordcor(multiple_archives, "evolution", "lithic")
nouns <- JSTOR_dtmofnouns(multiple_archives, word = NULL, sparse = 1, POStag = TRUE)
PCA_evolution <- JSTOR_clusterbywords(nouns, "evolution", f = 0.005)
custom_stopwords <- c('archaeology', 'university', 'research', 'evidence', 'journal', 'world', 'site', 'cambridge', 'archaeol', 'area', 'region', 'period', 'analysis', 'anthropology', 'springer', 'production', 'figure', 'work', 'world', 'concept', 'human', 'middle', 'altamira', 'culture', 'record', 'citation', 'discipline', 'author', 'proportion', 'literature', 'report', 'approach', 'cambridge' )
evolution_nouns <- JSTOR_dtmofnouns(multiple_archives, word = "evolution", sparse = 1, POStag = TRUE)

PCA_evolution_lithic <- JSTOR_clusterbywords(nouns, c("evolution","lithic"), f = 0.005)
evolution_lithic_nouns <- JSTOR_dtmofnouns(multiple_archives, word = c("evolution","lithic"), sparse = 1, POStag = TRUE)
```


#climate, climate&lithic

```{r}
JSTOR_1word(multiple_archives, "climate")
JSTOR_2words(multiple_archives, "climate", "lithic")
JSTOR_2wordcor(multiple_archives, "climate", "lithic")
nouns <- JSTOR_dtmofnouns(multiple_archives, word = NULL, sparse = 1, POStag = TRUE)
PCA_climate <- JSTOR_clusterbywords(nouns, "climate", f = 0.005)
custom_stopwords <- c('archaeology', 'university', 'research', 'evidence', 'journal', 'world', 'site', 'cambridge', 'archaeol', 'area', 'region', 'period', 'analysis', 'anthropology', 'springer', 'production', 'figure', 'work', 'world', 'concept', 'human', 'middle', 'altamira', 'culture', 'record', 'citation', 'discipline', 'author', 'proportion', 'literature', 'report', 'approach', 'cambridge' )
climate_nouns <- JSTOR_dtmofnouns(multiple_archives, word = "climate", sparse = 1, POStag = TRUE)

PCA_climate_lithic <- JSTOR_clusterbywords(nouns, c("climate","lithic"), f = 0.005)
climate_lithic_nouns <- JSTOR_dtmofnouns(multiple_archives, word = c("climate","lithic"), sparse = 1, POStag = TRUE)
```

#projectile, Paleolithic, blade

```{r}
JSTOR_1word(multiple_archives, "projectile")
JSTOR_2words(multiple_archives, "paleolithic", "projectile")
JSTOR_2wordcor(multiple_archives, "paleolithic", "projectile")
```




